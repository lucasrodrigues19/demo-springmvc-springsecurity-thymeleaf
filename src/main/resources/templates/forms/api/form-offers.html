<!DOCTYPE html>
<html  xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"  layout:decorate="~{layout}">
   <div layout:fragment="content">
		<th:block th:include="~{/fragments/fragment-product :: header(${#strings.capitalize('__#{offers}__')})}"></th:block>
		<div id="listProducts">
		 <div v-for="product in listProducts" class="card mb-3">	
		 	<div v-if="product.status === 'WANTED'" class="card-header alert-dark"><label>{{ product.name }}</label></div>
		 	<div v-else-if="product.status === 'PURCHASED'" class="card-header alert-success"><label>{{ product.name }}</label></div>
		 	<div v-else-if="product.status === 'WAITING_APPROVAL'"class="alert-warning card-header"><label>{{ product.name }}</label></div>
		 	<div v-else-if="product.status === 'DELIVERED'" class="card-header alert-default"><label >{{ product.name }}</label></div>
		 	<div class="card-body">
		 		<div class="row">
					<div class="col-12 col-sm-4">
						<label>Valor:</label>
						<input v-model="product.value" type="number" class="form-control" />
					</div>
					<div class="col-12 col-sm-4">
						<label>Data de entrega:</label>
						<input v-model="product.deliveryDate" class="form-control" data-mask="##/##/####" />
					</div>
				</div>
				<div class="row">
					 <div class="col-12 col-sm-8 mt-3">
						 <label>Producto</label>
						 <a v-bind:href="product.urlProduct">{{ product.name }}</a>
					</div>	 
					 <div class="col-12 col-sm-8 mt-3">
						<label >Descrição</label>
						<div>
							<textarea v-model="product.description" class="form-control" >{{product.description}}</textarea>
						</div>
					</div>
					<div class="col-12 col-sm-4">
						<div>
							<img class="img-thumbnail" v-bind:src="product.urlImage" />
						</div>
					</div>	
				</div>
			</div>
			<div class="card-footer">
				<button v-on:click="sendOffers(product)" class="btn btn-secondary mt-2">Enviar</button>
			</div>
		</div>
	</div>
   </div>
   <th:block layout:fragment="js">
   		<script src="https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js"></script>
   		<script src="https://unpkg.com/axios/dist/axios.min.js"></script>
   		<script>
		   	window.onload = (event) => {
		    	console.log('The page has fully loaded');
		    	var app = new Vue({
				  el: '#listProducts',
				  data: {
				    listProducts:[]
				  },
				   mounted () {
					    axios
					      .get('http://localhost:8080/api/products/status/waiting_approval')
					      .then(response => {
					        this.listProducts = response.data
					      })
					      .catch(error => {
					        console.log(error)
					      })
					      .finally(console.log('finally'))
				  },
				  methods: {
				  	    sendOffers: function(product){
				  	    	console.log('enviando ofertas: '+product)
				  	    }
				  }
				});
			}
   		</script>
   		
   </th:block>
</html>